import{d as xe,g as Q,c as A,b as C,f as me,n as Ee,h as r,j as T,w as ia,v as na,i as fe,m as sa,a as v,r as m,t as ce,o as br,s as Le,K as yr,V as Nt,k as gr,F as Vt,l as $t,D as ua,U as da,T as ca,H as ma,u as fa,$ as pa,C as va,e as k}from"./entry.ccfebbe1.js";import{u as ha}from"./composables.6e31dd6d.js";import{u as we}from"./v4.9a3e6124.js";import{i as _e,h as pt,v as vt,u as ya,g as ba,f as fr,a as pr,b as ga,c as Ca,d as _a,e as Ea,j as Fa,k as ka,l as wa,m as Sa,n as Na,o as Va,p as $a,q as xa,r as Aa,t as Ia,w as za,x as Da,y as Oa,z as Ua,A as Pa,B as Ta,C as Ma,D as Ba,E as Ra,F as qa}from"./TextElement.vue_vue_type_style_index_0_lang.00d54afa.js";/* empty css            */import{f as ht,i as La}from"./funnel_event_helper.bd666bbb.js";import{c as ja}from"./Countries.69e07731.js";import{u as yt,$ as Ha,x as vr,y as Wa,z as bt,w as Qe,r as Ze,A as gt,q as Ct,B as _t,C as Ka,m as Ga,D as Ja,E as Et}from"./helpers.9a9d5058.js";import{g as Ya,a as Qa,b as Za,d as Xa,s as Ft,e as kt,i as eo}from"./Attributions.46f38b13.js";import{u as ro}from"./index.98bfb2b5.js";import{a as to,_ as ao}from"./FunnelServices.6e08424a.js";import{_ as oo}from"./MoonLoader.vue_vue_type_style_index_0_lang.15aaa70a.js";import{S as lo}from"./HLConst.c4c5e8b3.js";import{_ as je}from"./InputText.vue_vue_type_script_setup_true_lang.e9424c7f.js";import{A as wt}from"./index.78c17736.js";const io=["type","disabled"],no=["innerHTML"],so=["innerHTML"],uo={style:{position:"absolute",left:"50%",transform:"translate(-50%, -50%)",top:"50%"},class:"loader-submit"},St=xe({__name:"ButtonElement",props:{item:{type:Object},calendar:{type:Object},formSubmitDisable:{type:Boolean},buttonStyle:{type:Object},errors:{type:Object}},emits:["click"],setup(i,{expose:d,emit:a}){const u=i,O=function(){a("click")},W=Q(()=>{var E;let D={};return(E=u==null?void 0:u.item)!=null&&E.bgColor?D={backgroundColor:"#"+u.item.bgColor,border:u.item.border+"px "+u.item.borderType+" #"+u.item.borderColor,borderRadius:u.item.radius+"px",padding:u.item.padding.top+"px "+u.item.padding.right+"px "+u.item.padding.bottom+"px "+u.item.padding.left+"px",width:u.item.fullwidth?"100%":"auto",whiteSpace:"normal",boxShadow:u.item.shadow.horizontal+"px "+u.item.shadow.vertical+"px "+u.item.shadow.blur+"px "+u.item.shadow.spread+"px #"+u.item.shadow.color}:D={backgroundColor:"#"+(u.buttonStyle.bgColor||"2A3135"),color:"#"+(u.buttonStyle.color||"FFFFFF"),border:(u.buttonStyle.border||0)+"px solid #"+(u.buttonStyle.borderColor||"000000"),borderRadius:(u.buttonStyle.radius||0)+"px",padding:(u.buttonStyle.padding||11)+"px",width:u.item.fullwidth?"100%":"auto",whiteSpace:"normal"},D});return d({item:u.item}),(D,E)=>{var _,F,b;const M=to;return v(),A("div",{class:"form-builder--item form-builder--btn-submit",style:Ee({textAlign:i.calendar?"center":i.item.align})},[C("div",{style:Ee([{width:i.item.fullwidth?"100%":"auto"},{display:"inline-block",position:"relative"}])},[C("button",{type:i.item.type,class:me([{invisible:i.formSubmitDisable,"btn btn-dark":!i.calendar,"hl_button --primary":i.calendar},"button-element"]),disabled:i.formSubmitDisable,onClick:O,style:Ee(r(W))},[((_=i.item)==null?void 0:_.label)&&r(yt)(i.item.label)?(v(),A("div",{key:0,style:Ee({color:"#"+i.item.color,fontSize:i.item.fontSize+"px",fontWeight:i.item.weight,fontFamily:i.item.fontFamily}),innerHTML:i.item.label},null,12,no)):T("",!0),((F=i.item)==null?void 0:F.submitSubText)&&r(yt)((b=i.item)==null?void 0:b.submitSubText)?(v(),A("div",{key:1,style:Ee({color:"#"+i.item.subTextColor,fontSize:i.item.subTextFontSize+"px",fontWeight:i.item.subTextWeight,fontFamily:i.item.subTextFontFamily}),innerHTML:i.item.submitSubText},null,12,so)):T("",!0)],14,io),ia(C("div",uo,[fe(M,null,{default:sa(()=>[fe(oo,{loading:i.formSubmitDisable,color:"#188bf6",size:"15px"},null,8,["loading"])]),_:1})],512),[[na,i.formSubmitDisable]])],4)],4)}}});const co={class:"terms-and-conditions"},mo=["id","value","name","checked","data-q","data-required"],fo=["innerHTML","for"],po={key:0,id:"error-container",class:"error"},vo=xe({__name:"TermsAndConditionsElement",props:{kind:{type:String},item:{type:Object},formLabelVisible:{type:Boolean},formFieldsValue:{type:Object},localTagId:{type:String},errors:{type:Object,default:()=>({})}},emits:["addOrUpdateError","handleCheckBox","updateFormFieldsValue"],setup(i,{expose:d,emit:a}){const u=i,O=Q(()=>u.kind==="form"),W=Q(()=>u.kind==="survey"),D=Q(()=>u.errors[u.item.tag]),E=m(null),M=h=>new DOMParser().parseFromString(h,"text/html").body.textContent||"",_=()=>{const p=E.value.checked?M(u.item.placeholder):!1;a("updateFormFieldsValue",{tag:u.item.tag,value:p})},F=()=>{var p;const h=(p=u.formFieldsValue)==null?void 0:p[u.item.tag];u.item.required&&!h?b(u.item.tag,"Please accept the terms and conditions"):b(u.item.tag,null)},b=(h,p)=>{a("addOrUpdateError",{tag:h,error:p})};return d({validate:F,item:u.item}),(h,p)=>{var y;return v(),A("div",{class:me(["form-builder--item",{"d-none":i.item.hidden,"form-builder--item-input":r(W)}])},[C("div",co,[C("input",{id:i.item.tag+"_"+i.localTagId,ref:I=>E.value=I,value:i.item.tag,name:r(O)?i.item.tag:i.item.label,checked:((y=i.formFieldsValue)==null?void 0:y[i.item.tag])!==void 0&&!!i.formFieldsValue[i.item.tag],onChange:p[0]||(p[0]=I=>_()),type:"checkbox","data-q":i.item.hiddenFieldQueryKey,"data-required":i.item.required},null,40,mo),C("label",{innerHTML:i.item.placeholder,style:{"margin-left":"10px"},for:i.item.tag+"_"+i.localTagId},null,8,fo)]),r(D)?(v(),A("div",po,ce(r(D)),1)):T("",!0)],2)}}});const ho={key:0,class:"menu-field-wrap col-12"},yo={class:"form-builder--item"},bo={key:0,class:"test-mode-badge"},go={key:1,class:"text-light"},Co={id:"card-element",ref:"card-element",class:"field"},_o={class:"outcome"},Eo={key:0,class:"error",role:"alert"},Fo=xe({__name:"StripePaymentElement",props:{calendar:{type:Object},payment:{type:Object},stripe:{type:Object},card:{type:Object},cardErrorMsg:{type:String}},emits:["updateStripe","updateCard","updateCardErrorMsg"],setup(i,{emit:d}){const a=i;br(()=>{Le(()=>{u()})});const u=()=>{try{if(a.payment===void 0||!a.payment.publishable_key)return"";const E=a.payment.account_id?{stripeAccount:a.payment.account_id}:null,M=Stripe(a.payment.publishable_key,E);O(M);const F=M.elements().create("card",{style:lo,hidePostalCode:!0});W(F)}catch(E){console.log("payment",E)}},O=E=>{d("updateStripe",E)},W=E=>{d("updateCard",E)},D=E=>{d("updateCardErrorMsg",E)};return yr(()=>a.card,()=>{a.card.mount("#card-element"),a.card.addEventListener("change",E=>{E.error?D(E.error.message):D("")})}),(E,M)=>i.payment?(v(),A("div",ho,[C("div",yo,[C("label",null,[Nt(" Secure Payment "),i.calendar.payment_mode!==void 0&&i.calendar.payment_mode===!1?(v(),A("span",bo,"Test Mode")):T("",!0),i.payment.description?(v(),A("small",go,"("+ce(i.payment.description)+")",1)):T("",!0)]),C("div",Co,null,512),C("div",_o,[i.cardErrorMsg?(v(),A("div",Eo,ce(i.cardErrorMsg),1)):T("",!0)])])])):T("",!0)}}),ko={class:"form-builder--item"},wo={key:0,class:"test-mode-badge"},So={key:1,class:"text-light"},No={class:"card-number"},Vo={class:"expiry-cvv-section"},$o={class:"expiry-input"},xo=C("label",{for:"cardExpiration"},"Expiration",-1),Ao=C("label",{for:"cardExpiration"},"CVC",-1),Io={class:"error",role:"alert"},zo={id:"authorize-net-error",class:"error",role:"alert"},Do=xe({__name:"AuthorizeNetPaymentElement",props:{calendar:{type:Object},payment:{type:Object},setAuthorizeNetNewCardDetails:{type:Function,required:!0},authorizeNetCardNumberError:{type:Boolean,required:!0},authorizeNetCardExpiryError:{type:Boolean,required:!0},authorizeNetCardCVCError:{type:Boolean,required:!0},setAuthorizeNetCardNumberError:{type:Function,required:!0},setAuthorizeNetExpiryError:{type:Function,required:!0},setAuthorizeNetCVCError:{type:Function,required:!0},authorizeNetErrorResponse:{type:String}},setup(i){const d=i,a=gr(),u=m(!1),O=m(!1),W=m(!1),D=m(!1),E=m(!1),M=m(!1),_=m(),F=m(),b=m(),h=m(""),p=m();br(()=>{I()});const y=Q(()=>d.calendar.payment_mode!==void 0&&d.calendar.payment_mode===!1);function I(){let f=document.createElement("script"),g=y.value?a.authorizeAcceptJsUrlTestMode:a.authorizeAcceptJsUrlLiveMode;f.setAttribute("src",g),f.setAttribute("charset","utf-8"),document.head.appendChild(f)}const G=f=>{var g;N((g=f==null?void 0:f.target)==null?void 0:g.value)},N=f=>{d.setAuthorizeNetCardNumberError(!1);const g=f.replace(/\D/g,"");return u.value=!1,O.value=!1,M.value=!1,W.value=!1,D.value=!1,E.value=!1,/^3[47]\d{0,13}$/.test(g)?(u.value=!0,p.value=17,_.value=g.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^3(?:0[0-5]|[68]\d)\d{0,11}$/.test(g)?(O.value=!0,p.value=16,_.value=g.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^4[0]\d{0,11}$/.test(g)?(W.value=!0,p.value=19,_.value=g.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{5})/,"$1 $2 ")):/^5[12345]\d{0,13}$/.test(g)?(M.value=!0,p.value=19,_.value=f.replace(/\W/gi,"").replace(/(.{4})/g,"$1 ")):/^5\d{0,14}$/.test(g)?(D.value=!0,p.value=17,_.value=g.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^6011\d{0,12}$/.test(g)||/^5\d{0,14}$/.test(g)?(D.value=!0,p.value=18,_.value=g.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):/^2131|1800\d{11}$/.test(g)?(E.value=!0,p.value=17,_.value=g.replace(/(\d{4})/,"$1 ").replace(/(\d{4}) (\d{6})/,"$1 $2 ")):(p.value=19,M.value=!0,_.value=f.replace(/\W/gi,"").replace(/(.{4})/g,"$1 ")),_.value=_.value.replace(/\s*$/,""),isNaN(Number(_.value.replace(/\s/g,"")))&&d.setAuthorizeNetCardNumberError(!0),_.value},He=f=>{var g,ue,Z,oe,ee;if(!_.value){d.setAuthorizeNetCardNumberError(!0);return}if(isNaN(Number(_.value.replace(/\s/g,""))))return d.setAuthorizeNetCardNumberError(!0);W&&_.value.length<15||(u.value||D.value)&&((g=_.value)==null?void 0:g.length)<17||O.value&&((ue=_.value)==null?void 0:ue.length)<16||M.value&&((Z=_.value)==null?void 0:Z.length)<19?d.setAuthorizeNetCardNumberError(!0):d.setAuthorizeNetCardNumberError(!1),u.value&&((oe=b.value)==null?void 0:oe.length)<4||!u.value&&((ee=b.value)==null?void 0:ee.length)<3?d.setAuthorizeNetCVCError(!0):d.setAuthorizeNetCVCError(!1),d.setAuthorizeNetNewCardDetails(_.value,F.value,b.value)},Se=f=>{f=f||window.event;var g=f.which?f.which:f.keyCode;return[37,39].indexOf(g)>-1?!0:g>31&&(g<48||g>57)?(f.preventDefault(),!1):!0},er=f=>{f.target.value.length>5||(d.setAuthorizeNetExpiryError(!1),F.value=f.target.value.replace(/^([1-9]\/|[2-9])$/g,"0$1 /").replace(/^(0[1-9]|1[0-2])$/g,"$1/").replace(/^([0-1])([3-9])$/g,"0$1/$2").replace(/^(0?[1-9]|1[0-2])([0-9]{2})$/g,"$1/$2").replace(/^([0]+)\/|[0]+$/g,"0").replace(/[^\d\/]|^[\/]*$/g,"").replace(/\/\//g,"/"))},We=f=>{var Ke;if(h.value="",!((Ke=f==null?void 0:f.target)!=null&&Ke.value)){h.value="",d.setAuthorizeNetExpiryError(!0);return}const g=f.target.value.split("/"),ue=Number(g[0]),Z=Number(g[1]),oe=new Date().getMonth()+1,ee=new Date().getFullYear()%100;!ue||!Z?(h.value="",d.setAuthorizeNetExpiryError(!0)):Z<ee?(d.setAuthorizeNetExpiryError(!0),h.value="Your card's expiration year is in the past."):Z>ee+50?(d.setAuthorizeNetExpiryError(!0),h.value="Your card's expiration year is invalid."):ue<oe&&Z==ee?(d.setAuthorizeNetExpiryError(!0),h.value="Your card's expiration month is in the past"):(h.value="",d.setAuthorizeNetExpiryError(!1)),d.setAuthorizeNetNewCardDetails(_.value,F.value,b.value)},pe=f=>{var g;b.value=(g=f==null?void 0:f.target)==null?void 0:g.value,u.value&&b.value.length<4||!u.value&&b.value.length<3?d.setAuthorizeNetCVCError(!0):d.setAuthorizeNetCVCError(!1),d.setAuthorizeNetNewCardDetails(_.value,F.value,b.value)};return(f,g)=>(v(),A("div",ko,[C("div",null,[C("label",null,[Nt(" Secure Payment "),r(y)?(v(),A("span",wo,"Test Mode")):T("",!0),i.payment.description?(v(),A("small",So,"("+ce(i.payment.description)+")",1)):T("",!0)]),C("span",No,ce(_.value),1),fe(je,{type:"text",name:"cc",autocomplete:"off",value:_.value,disabled:!1,id:"cc",maxlength:p.value,placeholder:"Card number",class:me(["form-control",d.authorizeNetCardNumberError?"text-box-error":""]),onKeyup:G,onKeydown:Se,onChange:He,onFocusout:He},null,8,["value","maxlength","class"])]),C("div",Vo,[C("div",$o,[xo,fe(je,{type:"text",name:"card-expiration",autocomplete:"off",value:F.value,disabled:!1,id:"card-expiration",maxlength:"5",placeholder:"MM / YY",class:me(["form-control",d.authorizeNetCardExpiryError?"text-box-error":""]),onKeydown:Se,onChange:We,onKeyup:er,onFocusout:We},null,8,["value","class"])]),C("div",null,[Ao,fe(je,{type:"text",name:"card-cvc",value:b.value,disabled:!1,id:"card-cvc",maxlength:u.value?"4":"3",placeholder:"CVC",class:me(["form-control",d.authorizeNetCardCVCError?"text-box-error":""]),onChange:pe,onKeydown:Se,onFocusout:pe},null,8,["value","maxlength","class"])])]),C("div",Io,ce(h.value),1),C("div",zo,ce(i.authorizeNetErrorResponse),1)]))}});var Oo=(i=>(i[i.STANDARD=0]="STANDARD",i[i.CUSTOM=1]="CUSTOM",i))(Oo||{});let Xe;const Uo=()=>({channel:"APP",source:"WEB_USER",version:"2021-04-15"}),hr=i=>{const d=gr().public;return Ha.create({baseURL:i||d.REST_API_URLS,headers:Uo()})},Po={generateRRuleText:i=>hr()("calendars/generate-rrule-text",{method:"POST",body:i}),getRecurringSlots:(i,d)=>{Xe&&Xe.abort(),Xe=new AbortController;const a=Xe.signal;return hr()(`calendars/${i}/recurring-slots`,{params:d,signal:a})},createRecurringEvents:i=>hr()("calendars/events/recurring-appointments",{method:"POST",body:i})};function To(){const i=m(!1),d=m(!1),a=m(!1),u=m();function O(F){E(""),i.value=F}function W(F){E(""),d.value=F}function D(F){E(""),a.value=F}function E(F){u.value=F}function M(){i.value=!1,d.value=!1,a.value=!1}async function _(F){return new Promise(function(b,h){window==null||window.Accept.dispatchData(F,function(p){var y,I;return((I=(y=p==null?void 0:p.messages)==null?void 0:y.resultCode)==null?void 0:I.toUpperCase())==="OK"?b(p):h({type:"authorizeNetServerError",response:p})})})}return{authorizeNetCardNumberError:i,authorizeNetCardExpiryError:d,authorizeNetCardCVCError:a,authorizeNetErrorResponse:u,setAuthorizeNetCardNumberError:O,setAuthorizeNetExpiryError:W,setAuthorizeNetCVCError:D,setAuthorizeNetErrorResponse:E,authorizeNetDispatchData:_,clearAuthorizeNetNewCardFormErrors:M}}const Mo={id:"add-guest-container",class:"menu-field-wrap col-sm-12 col-12 calendar_notes"},Bo=C("label",null,"Guests:",-1),Ro=["id"],qo=["id"],Lo=C("label",null,"Guest Name *",-1),jo={key:0,id:"error-container",class:"error"},Ho=["id"],Wo=C("label",null,"Guest Email *",-1),Ko={key:0,id:"error-container",class:"error"},Go=["onClick"],Jo=C("svg",{width:"17",height:"19",viewBox:"0 0 17 19",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[C("path",{d:"M11.6667 4.75001V4.11668C11.6667 3.22993 11.6667 2.78655 11.4941 2.44786C11.3423 2.14994 11.1001 1.90772 10.8022 1.75592C10.4635 1.58334 10.0201 1.58334 9.13333 1.58334H7.86667C6.97992 1.58334 6.53654 1.58334 6.19785 1.75592C5.89993 1.90772 5.65771 2.14994 5.50591 2.44786C5.33333 2.78655 5.33333 3.22993 5.33333 4.11668V4.75001M6.91667 9.10418V13.0625M10.0833 9.10418V13.0625M1.375 4.75001H15.625M14.0417 4.75001V13.6167C14.0417 14.9468 14.0417 15.6119 13.7828 16.1199C13.5551 16.5668 13.1918 16.9301 12.7449 17.1578C12.2369 17.4167 11.5718 17.4167 10.2417 17.4167H6.75833C5.42821 17.4167 4.76315 17.4167 4.25511 17.1578C3.80822 16.9301 3.44489 16.5668 3.21719 16.1199C2.95833 15.6119 2.95833 14.9468 2.95833 13.6167V4.75001",stroke:"#dc2626","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Yo=[Jo],Qo={key:0,class:"row add-guest-button"},Zo=C("svg",{width:"22",height:"20",viewBox:"0 0 16 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[C("path",{d:"M8.00001 9.33333H5.00001C4.06964 9.33333 3.60445 9.33333 3.22592 9.44816C2.37365 9.70669 1.7067 10.3736 1.44817 11.2259C1.33334 11.6044 1.33334 12.0696 1.33334 13M12.6667 13V9M10.6667 11H14.6667M9.66668 4C9.66668 5.65685 8.32353 7 6.66668 7C5.00982 7 3.66668 5.65685 3.66668 4C3.66668 2.34315 5.00982 1 6.66668 1C8.32353 1 9.66668 2.34315 9.66668 4Z",stroke:"#4188EE","stroke-width":"1.66667","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Xo=xe({__name:"AddGuest",props:{guests:{type:Array},formFieldsValue:{type:Object}},emits:["addOrUpdateError"],setup(i,{expose:d,emit:a}){const u=i,O=m(10),W=h=>{var p;(p=u.guests)==null||p.splice(h,1)},D=()=>{var p,y;b(),((p=u.guests)==null?void 0:p.find(I=>I.name===""||I.email===""))||(y=u.guests)==null||y.push({name:"",email:""})},E=(h,p)=>{p.name=h.target.value,p.invalidName=!1,p.nameError=""},M=(h,p)=>{p.email=h.target.value,p.invalidEmail=!1,p.emailError=""},_=h=>{_e(h.name)?h.nameError="Name is required":pt(h.name)||(h.nameError="Name is invalid"),h.invalidName=!_e(h.nameError)},F=h=>{var y,I;const p=(y=u.guests)==null?void 0:y.filter(G=>{var N;return h.email===G.email||h.email===((N=u.formFieldsValue)==null?void 0:N.email)});_e(h.email)?h.emailError="Email is required":vt(h.email)?(p&&(p==null?void 0:p.length)>1||h.email===((I=u.formFieldsValue)==null?void 0:I.email))&&(h.emailError="Email ID must be unique for guests."):h.emailError="Email is invalid!",h.invalidEmail=!_e(h.emailError)},b=()=>{var h,p;a("addOrUpdateError",{tag:"guestEmail",error:void 0}),(h=u.guests)==null||h.forEach(y=>{_e(y.name)?y.nameError="Name is required":pt(y.name)||(y.nameError="Name is invalid"),_e(y.email)?y.emailError="Email is required":vt(y.email)||(y.emailError="Email is invalid!"),y.invalidName=!_e(y.nameError),y.invalidEmail=!_e(y.emailError)}),(p=u.guests)==null||p.forEach(y=>{(y.invalidName||y.invalidEmail)&&a("addOrUpdateError",{tag:"guestEmail",error:y.emailError||y.nameError})})};return d({validate:b,guests:u.guests}),(h,p)=>(v(),A("div",Mo,[Bo,(v(!0),A(Vt,null,$t(i.guests,(y,I)=>(v(),A("div",{id:"guest"+I,class:"menu-field-wrap add-guest-row row"},[C("div",{id:"guest-name-"+I,class:"add-guest-name"},[Lo,fe(je,{type:"text",name:"name",value:y.name,disabled:!1,id:"guest-name-text",placeholder:"Name",class:"inputBox",onChange:G=>E(G,y),onBlur:G=>_(y)},null,8,["value","onChange","onBlur"]),y.invalidName?(v(),A("div",jo,ce(y.nameError),1)):T("",!0)],8,qo),C("div",{id:"guest-email-"+I,class:"add-guest-email"},[Wo,fe(je,{type:"text",name:"email",value:y.email,disabled:!1,id:"guest-email-text",placeholder:"Email",class:"inputBox",onChange:G=>M(G,y),onBlur:G=>F(y)},null,8,["value","onChange","onBlur"]),y.invalidEmail?(v(),A("div",Ko,ce(y.emailError),1)):T("",!0)],8,Ho),C("span",{class:me(["add-guest-row-delete w-20",I])},[C("i",{onClick:ua(G=>W(I),["prevent"])},Yo,8,Go)],2)],8,Ro))),256)),i.guests&&i.guests.length<r(O)?(v(),A("div",Qo,[Zo,C("a",{class:"action-add-guest",onClick:D},"Add Guest")])):T("",!0)]))}});const el={ref:"hl-app",class:"hl-app"},rl={id:"form-builder",class:"hl_form-builder--main"},tl={key:0},al={key:0,class:"menu-field-wrap col-sm-12 col-12"},gl=xe({__name:"FormComponent",props:{formId:{type:String,default:void 0},formData:{type:Object||Array,required:!0},calendar:{type:Object,default:void 0},selectedSlot:{type:Object,default:void 0},timezone:{type:String,default:void 0},event:{type:Object,default:void 0},error:{type:String,default:void 0},redirect:{type:Boolean,default:!0},funnelPreview:{type:Boolean,default:!1},formElementClass:{type:String,required:!1},calendarEventId:{type:String,required:!1},forCalendarV3:{type:Boolean,default:!1},pageUrl:{type:String,default:void 0},baseReferrrer:{type:String,default:void 0},urlParams:{type:Object,default:void 0},stickyContactData:{type:Object,default:void 0},stickyContactFingerprint:{type:String,default:void 0},iFrameId:{type:String,default:void 0},guests:{type:Array,default:[]}},emits:["step","processError","disableBackOnSubmit","onSubmit"],setup(i,{emit:d}){var Pr;const a=i,{t:u}=da(),O=gr();let W={},D={},E={},M=m(!0),_={},F=m(!1),b=m([]),h={},p={},y={},I=m(""),G=m(!1),N=m(!0),He={},Se=m(!1),er={},We={},pe=m(!1),f=m(""),g=m(!1),ue=m("US"),Z=m(),oe=m("");m("");let ee=m(""),Ke=m([]),Ne=m(!1);const Cr=m("");let rr=m(),Ae=m({}),tr=m(!0),ve=m(""),he=m(),Ge=m(),ar=m(),or=m(),K=m(),de=m(),Ie=m(),xt={},lr=m(),w=m([]),V=m(!1);const ir=m(""),ze=m(),e=ca({phoneCountryIncluded:W,phoneCountryCode:E,formattedPhone:D,form:_,formStyle:h,buttonStyle:p,company:He,formFieldsValue:er,validationError:We,fieldStyle:y,errors:xt}),nr=m(),sr=m(),ur=m(),Je=m(),{getFormStyle:At,setFormStyle:It,getFormWidth:_r}=ya(),{authorizeNetDispatchData:zt,setAuthorizeNetErrorResponse:dr,authorizeNetErrorResponse:Dt,authorizeNetCardNumberError:Er,authorizeNetCardExpiryError:Fr,authorizeNetCardCVCError:kr,setAuthorizeNetCardNumberError:wr,setAuthorizeNetExpiryError:Sr,setAuthorizeNetCVCError:Nr,clearAuthorizeNetNewCardFormErrors:Ot}=To(),Ut={bgColor:"E9ECEFFF",labelColor:((Pr=e==null?void 0:e.fieldStyle)==null?void 0:Pr.labelColor)||"",placeholderColor:"",border:"",width:"",padding:{top:15,bottom:15,left:20,right:20},shadow:""},U=l=>JSON.parse(Ga(JSON.stringify(l))),Vr=l=>{w.value.push(l)},Pt=()=>{var le,J,ie,Fe,be,ne,$,Ve,ge,B,z,X,te,ae,se,H,$e,Oe,Ue,Pe,Te,Me,Be,Re,n,S,R,Y,x,L,j,P,ke,qe,Ce,Tr,Mr,Br,Rr,qr,Lr,jr,Hr,Wr,Kr,Gr,Jr,Yr,Qr,Zr,Xr,et,rt,tt,at,ot,lt,it,nt,st,ut,dt,ct,mt;const{locationId:l,form:o,country:t}=a.formData;if(!l||!o)return;e.form=o,ee.value=(le=e.form)==null?void 0:le.fbPixelId,f.value=l,ue.value=t,Ne.value="stickyContact"in e.form?(J=e.form)==null?void 0:J.stickyContact:!1;const c=a.formElementClass?`.${a.formElementClass}${_t}`:_t;if("layout"in e.form&&(G.value=(ie=e.form)==null?void 0:ie.layout),"fields"in e.form&&(b.value=[...(Fe=e.form)==null?void 0:Fe.fields]),"style"in e.form){It((be=e==null?void 0:e.form)==null?void 0:be.style,(ne=e==null?void 0:e.form)==null?void 0:ne.width),ze.value=(Ve=($=a==null?void 0:a.formData)==null?void 0:$.form)==null?void 0:Ve.fieldCSS,ze.value&&!eo()&&a.formElementClass&&(ze.value=ze.value.replace(/#_builder-form/g,`.${a.formElementClass} #_builder-form`)),Se.value=(te=(B=(ge=e.form)==null?void 0:ge.style)==null?void 0:B.ac_branding)!=null?te:(X=(z=e.form)==null?void 0:z.style)==null?void 0:X.acBranding;const ft=(se=(ae=e.form)==null?void 0:ae.style)==null?void 0:se.bgImage;ft&&(Cr.value=`${a.funnelPreview?`.${a.formElementClass} #form-builder`:"body"} {background-image: url('${ft}');background-size: cover;}`)}((Oe=($e=(H=e.form.formAction)==null?void 0:H.headerImageSrc)==null?void 0:$e.trim())==null?void 0:Oe.length)>0&&(ir.value=e.form.formAction.headerImageSrc),"button"in e.form&&(e.buttonStyle={bgColor:(Pe=(Ue=e.form)==null?void 0:Ue.button)==null?void 0:Pe.background,color:(Me=(Te=e.form)==null?void 0:Te.button)==null?void 0:Me.color,border:((n=(Re=(Be=e.form)==null?void 0:Be.button)==null?void 0:Re.border)==null?void 0:n.border)||0,borderColor:((Y=(R=(S=e.form)==null?void 0:S.button)==null?void 0:R.border)==null?void 0:Y.color)||Ka,radius:(j=(L=(x=e.form)==null?void 0:x.button)==null?void 0:L.border)==null?void 0:j.radius,padding:(qe=(ke=(P=e.form)==null?void 0:P.button)==null?void 0:ke.border)==null?void 0:qe.padding}),(Tr=(Ce=e.form)==null?void 0:Ce.style)!=null&&Tr.color&&(rr.value=`${c}label{ color:#${(Br=(Mr=e.form)==null?void 0:Mr.style)==null?void 0:Br.color} }`),(qr=(Rr=e.form)==null?void 0:Rr.fieldStyle)!=null&&qr.labelColor&&(rr.value=`${c}label{ color:#${e.form.fieldStyle.labelColor} }`),"fieldStyle"in e.form?e.fieldStyle={bgColor:(jr=(Lr=e==null?void 0:e.form)==null?void 0:Lr.fieldStyle)==null?void 0:jr.bgColor,labelColor:(Wr=(Hr=e==null?void 0:e.form)==null?void 0:Hr.fieldStyle)==null?void 0:Wr.labelColor,placeholderColor:(Gr=(Kr=e==null?void 0:e.form)==null?void 0:Kr.fieldStyle)==null?void 0:Gr.placeholderColor,border:(Yr=(Jr=e==null?void 0:e.form)==null?void 0:Jr.fieldStyle)==null?void 0:Yr.border,width:(Zr=(Qr=e==null?void 0:e.form)==null?void 0:Qr.fieldStyle)==null?void 0:Zr.width,padding:(et=(Xr=e==null?void 0:e.form)==null?void 0:Xr.fieldStyle)==null?void 0:et.padding,shadow:(tt=(rt=e==null?void 0:e.form)==null?void 0:rt.fieldStyle)==null?void 0:tt.shadow}:e.fieldStyle=Ut,"customStyle"in e.form&&((ot=(at=e.form)==null?void 0:at.customStyle)==null?void 0:ot.length)>0&&(I.value=e.form.customStyle.replace(".form-element","")),"company"in e.form&&(e.company=(lt=e.form)==null?void 0:lt.company),"formLabelVisible"in e.form&&(N.value=(it=e.form)==null?void 0:it.formLabelVisible);let s=(nt=e.form)==null?void 0:nt.payment;s||((st=a.calendar)==null?void 0:st.stripe)&&(((dt=(ut=a.calendar)==null?void 0:ut.stripe)==null?void 0:dt.amount)==0||((mt=(ct=a.calendar)==null?void 0:ct.stripe)==null?void 0:mt.currency))&&(s=a.calendar.stripe),s&&(he.value={default_payment_provider:s.paymentProvider,publishable_key:s.publishable_key,account_id:s.account_id,amount:(parseFloat(s.amount)*100).toFixed(2),name:s.amount?"Pay to processed":"Verify your card",description:s.charge_description,currency:s.currency}),M.value=!1},cr=ro(),re=ma(),{$bus:$r}=fa(),ye=m([]),Tt=m(ba(a.formData));Pt();const xr=Q(()=>b.value.find(l=>l.type==="submit")),Ar=Q(()=>a.calendar&&a.calendar.enable_guests),Ir=Q(()=>{var l;return((l=he.value)==null?void 0:l.default_payment_provider)==="stripe"}),zr=Q(()=>{var l;return((l=he.value)==null?void 0:l.default_payment_provider)==="authorize-net"}),Mt=Q(()=>Ja.find(l=>l.code===ue.value)),Dr=Q(()=>Z.value||ue.value),Bt=Q(()=>Object.values(ja));Q(()=>e.formStyle.border==="0"?"form-top-padding":""),br(()=>{let l=!1;fr(a.urlParams,re,e.phoneCountryIncluded,K.value,e.formFieldsValue,b.value).then(o=>{e.phoneCountryIncluded=o.phoneCountryIncluded,e.formFieldsValue=o.formFieldsValue,K.value=o.formattedCountry,b.value=o.formFields}),b.value.map(o=>{if(o.type==="textbox_list"){const t={};o.picklistOptions.forEach(c=>{t[c.id]=c.prefillValue}),e.formFieldsValue[o.tag]=t}else o.type==="source"?e.formFieldsValue[o.tag]=o.value:o.type==="checkbox"&&!(e.formFieldsValue[o.tag]instanceof Array)?e.formFieldsValue[o.tag]=[]:o.type==="submit"&&(l=!0,a.calendar&&(o.label&&o.label.toLowerCase()==="button"||o.label.trim().length<=0)&&(o.label=u(a.forCalendarV3?"schedule_meeting":"book_appointment")))}),l||b.value.push({label:a.calendar?u(a.forCalendarV3?"schedule_meeting":"book_appointment"):u("submit"),tag:"button",palceholder:"button",type:"submit"}),!a.funnelPreview&&ee.value!==void 0&&ee.value!==""&&Le(()=>{La(ee.value,e.form.pageViewEvent)}),Ne.value&&(ye.value=b.value.map(o=>o.tag),pr(void 0,f.value,ye.value,e.formFieldsValue,e.phoneCountryIncluded,K.value).then(o=>{o?(e.formFieldsValue=o.formFieldsValue,e.phoneCountryIncluded=o.phoneCountryIncluded,K.value=o.formattedCountry):console.warn("Data not found! skippping stickycontact fill")}).catch(o=>{console.error("Failed at fillDataFromCookie",o)})),b.value.length>0&&b.value.forEach((o,t)=>{if(o.type==="html"&&o&&"html"in o){const c=o.html.replace(/[‘’]/g,"'").replace(/[“”]/g,'"');Ke.value.push({scriptString:c,index:t})}}),Le(()=>{F.value=!0}),ve.value=Math.random().toString(36).slice(2),$r.$on("submitCalendarForm",Ye),re.query.hasOwnProperty("sticky_contact_help")&&re.query.sticky_contact_help==="true"&&(console.log("%c Sticky Contact data","color: black; font-weight: bold; background-color: white"),console.log("%c ===================","color: black; font-weight: bold; background-color: white"),console.log(JSON.parse(vr("_ud"))),console.log("%c ===================","color: black; font-weight: bold; background-color: white")),a.urlParams&&fr(a.urlParams,re,e.phoneCountryIncluded,K.value,e.formFieldsValue,b.value).then(o=>{e.phoneCountryIncluded=o.phoneCountryIncluded,e.formFieldsValue=o.formFieldsValue,K.value=o.formattedCountry,b.value=o.formFields}),a.stickyContactData&&Ne.value&&(ye.value||(ye.value=b.value.map(o=>o.tag)),pr(a.stickyContactData,f.value,ye.value,e.formFieldsValue,e.phoneCountryIncluded,K.value).then(o=>{e.formFieldsValue=o.formFieldsValue,e.phoneCountryIncluded=o.phoneCountryIncluded,K.value=o.formattedCountry}).catch(o=>{console.error("Failed at fillDataFromCookie at sticky contact",o)})),V.value=!0,ha({__dangerouslyDisableSanitizers:["style"],style:[{children:Cr.value,type:"text/css"},{children:ze.value,type:"text/css"},{children:rr.value,type:"text/css"},{children:I.value,type:"text/css"}],link:[...Tt.value]})}),pa(()=>{w.value=[]}),yr(()=>a.urlParams,(l,o)=>{a.urlParams&&fr(a.urlParams,re,e.phoneCountryIncluded,K.value,e.formFieldsValue,b.value).then(t=>{e.phoneCountryIncluded=t.phoneCountryIncluded,e.formFieldsValue=t.formFieldsValue,K.value=t.formattedCountry,b.value=t.formFields})}),yr(()=>a.stickyContactData,(l,o)=>{a.stickyContactData&&Ne.value&&(ye.value||(ye.value=b.value.map(t=>t.tag)),pr(a.stickyContactData,f.value,ye.value,e.formFieldsValue,e.phoneCountryIncluded,K.value).then(t=>{e.formFieldsValue=t.formFieldsValue,e.phoneCountryIncluded=t.phoneCountryIncluded,K.value=t.formattedCountry}).catch(t=>{console.error("Failed at fillDataFromCookie at sticky contact",t)}))});const Or=l=>{Z.value=l},Rt=l=>{e.validationError=l},qt=l=>{Ge.value=l},Lt=l=>{ar.value=l},jt=(l,o,t)=>{nr.value=l&&l.length?l.replace(/\s/g,""):null,o&&o.length&&o.includes("/")&&(o=o.split("/"),sr.value=o[0],ur.value=o[1]),Je.value=t},Ht=l=>{de.value=l},De=l=>{const{tag:o,value:t}=l;e.formFieldsValue[o]=t},Wt=l=>{K.value=l},Kt=l=>{Ie.value=l},q=l=>{const{tag:o,error:t}=l;e.errors[o]=t,Gt(l),Ur()},Gt=l=>{const{tag:o,error:t}=l;o=="email"&&a.guests.length>=1&&a.guests.forEach(c=>{c.email===e.formFieldsValue[o]?(c.emailError="Email IDs must be unique for guests.",c.invalidEmail=!0):(c.emailError="",c.invalidEmail=!1)})},Jt=l=>{lr.value=l},Yt=l=>{const{date:o,item:t}=l;e.formFieldsValue[t.tag]=o},mr=l=>{const o=e.phoneCountryIncluded[l.tag],t=e.phoneCountryCode[l.tag];e.formFieldsValue[l.tag]=o,l.tag==="phone"&&(oe.value=e.formFieldsValue[l.tag]);try{const c=window.libphonenumber.parsePhoneNumberFromString(o,t);e.phoneCountryIncluded[l.tag]=c.isValid()?c.number:o,e.phoneCountryCode[l.tag]=c.country?c.country:t,e.formattedPhone[l.tag]=c.isValid()?c.formatNational():o}catch{e.phoneCountryIncluded[l.tag]=o,e.formattedPhone[l.tag]=o}},Qt=()=>{let l=!1,o=0;return b.value.map(t=>{t.type==="cascade_dropdown"&&t.required&&e.formFieldsValue[t.tag]===void 0?(tr.value=!1,l=!0):e.formFieldsValue[t.tag]!==void 0&&t.type==="cascade_dropdown"&&(e.formFieldsValue[t.tag].forEach(function(s){for(const le in s)s[le]===""&&o++}),o>0?(tr.value=!1,l=!0):tr.value=!0)}),l},Zt=async()=>{const l=w.value.map(t=>{t.validate&&t.validate()});return await Promise.all(l),await Ur()},Xt=async()=>{let l=!1;const o=w.value.map(t=>{var c;((c=t==null?void 0:t.item)==null?void 0:c.type)==="captcha"&&(l=!0)});return await Promise.all(o),l},Ur=async()=>{const l=Object.values(e.errors);let o=!1;return await Promise.all(l.map(t=>{t&&(o=!0)})),o},ea=l=>{let o=0,t=0;return b.value.map(function(c,s){Et.indexOf(c.type)<0&&(o++,t=s)}),o%2!==0&&b.value[t].tag===l},ra=l=>Et.indexOf(l)>=0,ta=l=>{e.formFieldsValue[l.tag]=""},aa=l=>{const{item:o,event:t}=l;e.formFieldsValue[o.tag]=t.target.value},Ye=async l=>{var be,ne,$,Ve,ge;let o;if(l!=null&&l.isRecurring&&(o=l.isRecurring),de.value)return;const t=o!=null?o:(be=a.calendar)==null?void 0:be.enable_recurring;for(let B in e.phoneCountryIncluded)e.phoneCountryIncluded[B]&&mr({tag:B});if(await ga(e.formFieldsValue)>Wa){alert("The total size of the attached files cannot be more that 50MB");return}if(e.validationError={},console.log("captchaInputValue",Ie.value),await Zt()||Qt())return;if(await Xt()&&(Ie.value===void 0||Ie.value==="0")){e.validationError.captcha="Invalid Captcha";return}let J;if(d("disableBackOnSubmit",{disable:!0}),g.value=!0,de.value="",Ir.value&&he.value&&!or.value){J={};try{const{client_secret:B}=await $fetch(O.serverBaseUrl+"/appointment/setup-intent",{method:"POST",body:{locationId:a.formData.locationId,calendarId:a.calendar.id}});if(!B)throw de.value="Something went wrong while processing your payment, please try again.",new Error("clientSecret missing");let z,X;if(e.formFieldsValue.first_name&&(X=e.formFieldsValue.first_name.trim()),e.formFieldsValue.full_name&&(X=e.formFieldsValue.full_name.trim()),z=await Ge.value.confirmCardSetup(B,{payment_method:{card:ar.value,billing_details:X?{name:X}:{}}},{handleActions:!1}),z.error)throw de.value=z.error.message,z.error;{const te={...e.formFieldsValue};if(Ne.value){let H;if(typeof Storage<"u")try{H=vr(f.value)}catch{console.error("Failed to fetch contact from local storage")}H||(H=we(f.value).value||we("msgsndr_id").value),H&&(te.contact_id=H)}oe.value&&(te.phone=oe.value);const ae={location_id:f.value,calendar_id:a.calendar.id,payment_method_id:z.setupIntent.payment_method,setup_intent_status:z.setupIntent.status,customer_data:te},se=await $fetch(O.serverBaseUrl+"/appointment/setup-stripe-customer-and-payment-intent",{method:"POST",body:ae});if(se.status==="requires_action"){const H=await Ge.value.handleCardAction(se.client_secret);if(H.error)throw de.value=H.error.message,H.error;J.payment_intent_id=H.paymentIntent.id}else J.payment_intent_id=se.id;J.stripe_customer_id=se.stripe_customer_id}}catch(B){return console.error(B),de.value||(de.value="Something went wrong while processing your payment, please try again."),d("disableBackOnSubmit",{disable:!1}),g.value=!1,!1}}if(zr.value&&he.value){J={};let B=!1;if(nr.value||(wr(!0),B=!0),(!sr.value||!ur.value)&&(Sr(!0),B=!0),Je.value||(Nr(!0),B=!0),B||Er.value||Fr.value||kr.value)return;dr(""),Ot();try{const{publishable_key:z,account_id:X}=he.value,te={authData:{clientKey:z,apiLoginID:X},cardData:{cardNumber:nr.value,month:sr.value,year:ur.value,cardCode:Je.value}},ae=await zt(te);J={opaqueData:ae==null?void 0:ae.opaqueData,cardCode:Je.value}}catch(z){if(z.type==="authorizeNetServerError"){dr((ge=(Ve=($=(ne=z==null?void 0:z.response)==null?void 0:ne.messages)==null?void 0:$.message)==null?void 0:Ve[0])==null?void 0:ge.text);return}dr((z==null?void 0:z.message)||"Something went wrong!")}}const ie=await Ca(e.formFieldsValue,K.value);e.formFieldsValue=ie.formFieldsValue;const Fe=await _a(re,b.value,e.formFieldsValue);e.formFieldsValue=Fe.formFieldsValue,await la(J,{isRecurring:t}),d("disableBackOnSubmit",{disable:!0})},oa=l=>{const o={};for(const t in l)l.hasOwnProperty(t)&&(o[t.replace(/(\_\w)/g,function(c){return c[1].toUpperCase()})]=l[t]);return o},la=async(l,{isRecurring:o})=>{var z,X,te,ae,se,H,$e,Oe,Ue,Pe,Te,Me,Be,Re;const t=we("msgsndr_id").value;if(a.formId&&(e.formFieldsValue.formId=a.formId),e.formFieldsValue.location_id=f.value,oe.value&&(e.formFieldsValue.phone=oe.value),Ne.value){let n;if(a.stickyContactFingerprint&&(n=a.stickyContactFingerprint),!n&&typeof Storage<"u")try{n=vr(f.value)}catch{console.error("Failed to get contact from local storage")}n||(n=we(f.value).value||t),n&&(e.formFieldsValue.contact_id=n)}const c=re.query.contact_id||((z=a.urlParams)==null?void 0:z.contact_id);c&&(e.formFieldsValue.query_contact_id=c);const s=e.formFieldsValue;let le=null;(X=a.calendar)!=null&&X.form_submit_type?a.calendar.form_submit_type==="RedirectURL"&&(le=a.calendar.form_submit_redirect_url||a.calendar.thank_you_url):((se=(ae=(te=a.calendar)==null?void 0:te.thank_you_url)==null?void 0:ae.trim())==null?void 0:se.length)>0&&(le=a.calendar.thank_you_url),a.event?s.event_id=re.query.event_id:a.calendarEventId&&(s.event_id=a.calendarEventId),a.guests.length&&(s.guests=a.guests.map(({name:n,email:S})=>({name:n,email:S}))),a.calendar&&(s.calendar_id=a.calendar.id,s.selected_slot=a.selectedSlot.format(),s.selected_timezone=a.timezone),or.value?s.stripeToken=or.value:l&&(s.stripePaymentResult=l);const J=Ya(s.locationId);J&&(s.sessionId=J);const ie=Qa();s.eventData={...Za(a.pageUrl,a.baseReferrrer),fbEventId:ie};let Fe=Xa(s.locationId);if(Fe&&(s.sessionFingerprint=Fe),a.funnelPreview){let{domain:n,page_url:S}=re.query;n||(n=window.location.hostname,S=window.location.pathname),s.funneEventData={event_type:"optin",domain_name:n,page_url:S,funnel_id:cr.value.funnelId,page_id:cr.value.funnelPageId,funnel_step_id:cr.value.stepId}}lr.value&&(s.captchaToken=lr.value);let be=O.REST_API_URLS+"/forms/submit";a.calendar&&(be=O.serverBaseUrl+"/appointment");let ne=new FormData,$={};Object.keys(s).forEach(async n=>{var S;if(s[n]instanceof File)ne.append(n,s[n]);else if((S=s[n])!=null&&S.files){const R=Object.values(s[n].files);R.length&&await Promise.all(R.map(Y=>{ne.append(n,Y)}))}else(s[n]||s[n]===0)&&($[n]=s[n])}),re.query.user_id&&($.user_id=re.query.user_id);const ge=we("am_id").value,B=we("am_fingerprint").value;if(ge&&($.amId=ge),B&&($.amFingerprint=B),a.calendar?($.eventData.medium=wt.Calendar,$.eventData.mediumId=$==null?void 0:$.calendar_id):($.eventData.medium=wt.Form,$.eventData.mediumId=$==null?void 0:$.formId),!o)ne.set("formData",JSON.stringify($)),$fetch(be,{method:"POST",body:ne}).then(async n=>{var S,R;if(n.status||n.id){let Y=n.formData,x=n.fingerprint,L=n.sessionFingerprint,j={};if(t!==x){const P=we("msgsndr_id",{path:"/",maxAge:31536e3});P.value=x}try{a.calendar&&(Y=e.formFieldsValue,x=n.contactId);const P="_ud";j=await bt(n.contact,!0),a.calendar&&(j={...j,appointment:n.appointment}),Qe(P,JSON.stringify(j)),Qe(f.value,x),window.parent.postMessage(["set-sticky-contacts",P,JSON.stringify(j),f.value,x],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${a.iFrameId}`,a.iFrameId,f.value,x],"*"),a.event||(Ft({sessionId:n.sessionId||null,locationId:f.value}),L&&kt(f.value,L)),d("onSubmit",{fingerprint:x})}catch(P){const ke={formData:Y||n,eventId:n.id,error:P.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};await $fetch(O.serverBaseUrl+"/appointment/booking-error",{method:"POST",body:ke})}if(a.calendar||Le(()=>{ht("track",e.form.formSubmissionEvent,ie)}),a.calendar){const P={contactId:n.contactId,calendarThankYouUrl:le,id:n.id,fingerprint:x,event_address:n.event_address,cookiePayload:j,fbEventId:ie};d("step",P);return}if(a.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1){const P=Ze(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,j);gt(P)}else if("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!==""){const P=Ze(e.form.redirect_url||e.form.redirectUrl,j);gt(P)}else{pe.value=!0;const P=e.form.formAction.thankyouText?Ct(e.form.formAction.thankyouText,j):"Thanks for submiting details, Will get back to you soon!";Ae.value={action:"submit-form",message:P,style:e.form.submitMessageStyle,isFormPosted:pe.value,height:(R=(S=a.formData)==null?void 0:S.form)==null?void 0:R.height}}}}).catch(n=>{var S,R,Y,x,L,j,P,ke,qe;if(console.error("error",n),a.calendar){let Ce="";((S=n==null?void 0:n.response)==null?void 0:S.status)===502?Ce=((Y=(R=n==null?void 0:n.response)==null?void 0:R._data)==null?void 0:Y.msg)||((L=(x=n==null?void 0:n.response)==null?void 0:x.data)==null?void 0:L.msg)||"Something went wrong with your payment. Please try again.":(Ce=((P=(j=n==null?void 0:n.response)==null?void 0:j._data)==null?void 0:P.msg)||((qe=(ke=n==null?void 0:n.response)==null?void 0:ke.data)==null?void 0:qe.msg)||u("unable_to_schedule_appointment"),Ce=Ce||"unable_to_schedule_appointment"),d("processError",{error:Ce})}});else try{$.source="booking_widget",$.channel="private_api";const n=await Po.createRecurringEvents(oa($));if(n.ids&&n.ids.length){let S,R=n.fingerprint,Y=n.sessionFingerprint,x={};try{a.calendar&&(S=e.formFieldsValue,R=n.contactId);const L="_ud";x=await bt(n.contact,!0),a.calendar&&(x={...x,appointment:n.appointment}),Qe(L,JSON.stringify(x)),Qe(f.value,R),window.parent.postMessage(["set-sticky-contacts",L,JSON.stringify(x),f.value,R],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${a.iFrameId}`,a.iFrameId,f.value,R],"*"),a.event||(Ft({sessionId:n.sessionId||null,locationId:f.value}),Y&&kt(f.value,Y)),d("onSubmit",{fingerprint:R})}catch(L){const j={formData:S||n,eventId:n.ids.join(","),error:L.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};await $fetch(O.serverBaseUrl+"/appointment/booking-error",{method:"POST",body:j})}if(a.calendar||Le(()=>{ht("track",e.form.formSubmissionEvent,ie)}),a.calendar){const L={contactId:n.contactId,calendarThankYouUrl:le,ids:n.ids,fingerprint:R,event_address:n.eventAddress||"",cookiePayload:x,fbEventId:ie};d("step",L);return}if(a.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1)window.top.location.href=Ze(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,x);else if("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!=="")window.top.location.href=Ze(e.form.redirect_url||e.form.redirectUrl,x);else{pe.value=!0;const L=e.form.formAction.thankyouText?Ct(e.form.formAction.thankyouText,x):"Thanks for submiting details, Will get back to you soon!";Ae.value={action:"submit-form",message:L,style:e.form.submitMessageStyle,isFormPosted:pe.value,height:($e=(H=a.formData)==null?void 0:H.form)==null?void 0:$e.height}}}}catch(n){if(console.error("error",n),a.calendar){let S="";((Oe=n==null?void 0:n.response)==null?void 0:Oe.status)===502?S=((Pe=(Ue=n==null?void 0:n.response)==null?void 0:Ue.data)==null?void 0:Pe.msg)||"Something went wrong with your payment. Please try again.":(S=((Me=(Te=n==null?void 0:n.response)==null?void 0:Te.data)==null?void 0:Me.msg)||u("unable_to_schedule_appointment"),S=((Re=(Be=n==null?void 0:n.response)==null?void 0:Be.data)==null?void 0:Re.msg)||"unable_to_schedule_appointment"),d("processError",{error:S})}}};return va(()=>{$r.$off("submitCalendarForm",Ye)}),(l,o)=>(v(),A("div",el,[C("section",rl,[r(ir).trim().length>0&&r(V)?(v(),A("div",tl,[C("div",{class:"max-w-full ghl-banner w-full",style:Ee({maxWidth:r(_r)+"px"})},[fe(ao,{url:r(ir),alt:"banner"},null,8,["url"])],4)])):T("",!0),C("div",{style:Ee({maxWidth:r(_r)+"px"}),class:"ghl-form-wrap"},[r(pe)?T("",!0):(v(),A("div",{key:0,id:"_builder-form",style:Ee(r(At)()),name:"builder-form",class:"form-builder--wrap"},[C("div",{class:me([r(G)?"builder-inline":"",r(N)?"":"extra-top-padding","fields-container row"])},[(v(!0),A(Vt,null,$t(r(b),(t,c)=>(v(),A("div",{key:c,class:me([r(G)&&!ra(t.type)&&!ea(t.tag)?"menu-field-wrap col-sm-6 col-6":"menu-field-wrap col-12",{calendar_notes:t.tag==="calendar_notes"},{"payment-block":t.type==="payment"}])},[C("div",{class:me([c%2==0?"f-even":"f-odd","form-field-container"])},[t.type==="text"&&r(V)?(v(),k(ka,{key:0,kind:"form",item:U(t),"form-label-visible":r(N),"phone-country-included":r(e).phoneCountryIncluded,"phone-country-code":r(e).phoneCountryCode,"location-country":r(Dr),"form-fields-value":r(e).formFieldsValue,"formatted-phone":r(e).formattedPhone,"phone-country-derived":r(Z),errors:r(e).errors,onUpdatePhoneCountryDerived:Or,onCustomFieldPhoneNumberUpdate:mr,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","form-fields-value","formatted-phone","phone-country-derived","errors"])):t.type==="phone"&&r(V)?(v(),k(wa,{key:1,kind:"form",item:U(t),"form-label-visible":r(N),"phone-country-included":r(e).phoneCountryIncluded,"phone-country-code":r(e).phoneCountryCode,"location-country":r(Dr),"phone-country-derived":r(Z),"formatted-phone":r(e).formattedPhone,errors:r(e).errors,onAddOrUpdateError:q,onUpdatePhoneCountryDerived:Or,onCustomFieldPhoneNumberUpdate:mr,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","phone-country-included","phone-country-code","location-country","phone-country-derived","formatted-phone","errors"])):(t.type==="number"||t.type==="numerical")&&r(V)?(v(),k(Sa,{key:2,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="email"&&r(V)?(v(),k(Na,{key:3,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","errors"])):T("",!0),t.type==="h1"?(v(),k(Va,{key:4,item:U(t)},null,8,["item"])):t.type==="textbox_list"&&r(V)?(v(),k($a,{key:5,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ve),errors:r(e).errors,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):(t.type==="textarea"||t.type=="large_text")&&r(V)?(v(),k(xa,{key:6,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="img"&&"url"in t?(v(),k(Aa,{key:7,kind:"form",item:U(t),ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item"])):t.type==="html"?(v(),k(Ia,{key:8,item:U(t),localTagId:r(ve)+c,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","localTagId"])):t.type==="captcha"&&r(V)?(v(),k(za,{key:9,kind:"form",item:U(t),"form-label-visible":r(N),"captcha-input-value":r(Ie),"local-tag-id":r(ve),"validation-error":r(e).validationError,onUpdateValidationError:Rt,onUpdateIsCaptchaVerified:Kt,onUpdateCaptchaToken:Jt,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","captcha-input-value","local-tag-id","validation-error"])):t.type==="monetory"&&r(V)?(v(),k(Da,{key:10,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,"locale-currency":r(Mt),errors:r(e).errors,onAddOrUpdateError:q,onUpdateFormFieldsValue:De,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","locale-currency","errors"])):t.type==="checkbox"&&r(V)?(v(),k(Oa,{key:11,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ve),errors:r(e).errors,onAddOrUpdateError:q,onUpdateFormFieldsValue:De,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="terms_and_conditions"&&r(V)?(v(),k(vo,{key:12,kind:"form",item:t,"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ve),errors:r(e).errors,onAddOrUpdateError:q,onUpdateFormFieldsValue:De,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="radio"&&t.picklistOptions&&r(V)?(v(),k(Ua,{key:13,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ve),errors:r(e).errors,onAddOrUpdateError:q,onResetFieldsValue:ta,onSetRadioValue:aa,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="radio"&&t.picklistOptionsImage&&r(V)?(v(),k(Pa,{key:14,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,"local-tag-id":r(ve),errors:r(e).errors,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","local-tag-id","errors"])):t.type==="select"&&t.tag=="country"&&r(V)?(v(),k(Ta,{key:15,kind:"form",item:U(t),"form-label-visible":r(N),"formatted-country":r(K),countries:r(Bt),errors:r(e).errors,onUpdateFormattedCountry:Wt,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","formatted-country","countries","errors"])):(t.type==="single_options"||t.type==="multiple_options")&&r(V)?(v(),k(Ma,{key:16,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="date"&&r(V)?(v(),k(Ba,{key:17,kind:"form",item:U(t),"form-label-visible":r(N),"form-fields-value":r(e).formFieldsValue,errors:r(e).errors,ref_for:!0,ref:s=>{r(w)[c]=s},onDateSelected:Yt,onAddOrUpdateError:q},null,8,["item","form-label-visible","form-fields-value","errors"])):t.type==="payment"&&r(Ir)&&r(V)?(v(),k(Fo,{key:18,calendar:i.calendar,payment:r(he),stripe:r(Ge),card:r(ar),"card-error-msg":r(de),onUpdateStripe:qt,onUpdateCard:Lt,onUpdateCardErrorMsg:Ht,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["calendar","payment","stripe","card","card-error-msg"])):t.type==="payment"&&r(zr)&&r(V)?(v(),k(Do,{key:19,kind:"form",calendar:i.calendar,payment:r(he),setAuthorizeNetNewCardDetails:jt,authorizeNetCardNumberError:r(Er),authorizeNetCardExpiryError:r(Fr),authorizeNetCardCVCError:r(kr),setAuthorizeNetCardNumberError:r(wr),setAuthorizeNetExpiryError:r(Sr),setAuthorizeNetCVCError:r(Nr),authorizeNetErrorResponse:r(Dt)},null,8,["calendar","payment","authorizeNetCardNumberError","authorizeNetCardExpiryError","authorizeNetCardCVCError","setAuthorizeNetCardNumberError","setAuthorizeNetExpiryError","setAuthorizeNetCVCError","authorizeNetErrorResponse"])):t.type==="file_upload"&&r(V)?(v(),k(Ra,{key:20,kind:"form",item:U(t),"form-fields-value":r(e).formFieldsValue,"form-label-visible":r(N),errors:r(e).errors,onUpdateFormFieldsValue:De,onAddOrUpdateError:q,ref_for:!0,ref:s=>{r(w)[c]=s}},null,8,["item","form-fields-value","form-label-visible","errors"])):t.type==="signature"&&r(V)?(v(),k(qa,{key:21,kind:"form",item:U(t),"form-fields-value":r(e).formFieldsValue,"form-label-visible":r(N),ref_for:!0,ref:s=>{r(w)[c]=s},errors:r(e).errors,onUpdateFormFieldsValue:De,onAddOrUpdateError:q},null,8,["item","form-fields-value","form-label-visible","errors"])):t.type==="submit"&&r(V)&&!r(Ar)?(v(),k(St,{key:22,item:U(t),"button-style":r(e).buttonStyle,calendar:i.calendar,"form-submit-disable":r(g),onClick:Ye,ref_for:!0,ref:s=>{r(w)[c]=s},errors:r(e).errors},null,8,["item","button-style","calendar","form-submit-disable","errors"])):T("",!0)],2)],2))),128)),r(Ar)?(v(),A("div",al,[fe(Xo,{guests:i.guests,"form-fields-value":r(e).formFieldsValue,ref:t=>Vr(t),onAddOrUpdateError:q},null,8,["guests","form-fields-value"]),r(xr)&&r(V)?(v(),k(St,{key:0,item:r(xr),"button-style":r(e).buttonStyle,calendar:i.calendar,"form-submit-disable":r(g),onClick:Ye,ref:t=>Vr(t),errors:r(e).errors,class:"menu-field-wrap col-sm-12 col-12 calendar_notes mt-20"},null,8,["item","button-style","calendar","form-submit-disable","errors"])):T("",!0)])):T("",!0)],2),i.formData!=null&&r(Se)&&r(V)?(v(),k(Ea,{key:0,company:r(e).company},null,8,["company"])):T("",!0)],4)),r(Ae)&&r(Ae).isFormPosted?(v(),k(Fa,{key:1,id:"_builder-form",payload:r(Ae)},null,8,["payload"])):T("",!0)],4)])],512))}});export{Oo as A,Po as C,gl as _};
